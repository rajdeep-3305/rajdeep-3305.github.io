<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="UTF-8">
    <title>Rajdeep.</title>
    <meta name="description" content="Rajdeep's personal website.">
    <link rel="stylesheet" href="assets/css/normalize.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="icon" href="assets/img/casanova.png">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,500,0,0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0">

<style>
    /* CORE STYLES */
    body { background-color: #000000; color: #ffffff; min-height: 100vh; margin: 0; overflow-x: hidden; font-family: sans-serif; }
    
    /* CURSOR TRAIL CANVAS */
    #trail-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; }

    /* LINK & BUTTON STYLES */
    .link { padding: 5px 10px; border-radius: 4px; border: 1px solid transparent; transition: all 0.2s ease; text-decoration: none; color: #fff; }
    .link:hover { background: #ffffff; color: #000000; box-shadow: 0 0 15px rgba(255, 255, 255, 0.6); }
    
    .table { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.15); box-shadow: 0 0 15px rgba(0, 0, 0, 0.8); transition: transform 0.1s ease, border-color 0.2s ease; margin-bottom: 20px; padding: 20px; border-radius: 10px; }
    .table:hover { border-color: rgba(255, 255, 255, 0.4); background: rgba(255, 255, 255, 0.05); }

    .button { border: 1px solid rgba(255, 255, 255, 0.3); background: rgba(0, 0, 0, 0.7); color: #eee; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); display: inline-flex; align-items: center; text-decoration: none; padding: 10px 20px; margin-right: 10px; margin-bottom: 10px; border-radius: 4px; cursor: pointer; }
    .button:hover { background: #ffffff; color: #000000; box-shadow: 0 0 15px rgba(255, 255, 255, 0.6); }

    /* HEADER & PHOTO */
    #userPhoto { border: 2px solid rgba(255,255,255,0.2); box-shadow: 0 0 20px rgba(255,255,255,0.1); transition: 0.3s; width: 100px; height: 100px; border-radius: 50%; }
    #userPhoto:hover { transform: scale(1.1); border-color: #ffffff; box-shadow: 0 0 30px rgba(255,255,255,0.8); }
    
    /* MODAL STYLES (The Popup) */
    #romModal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); backdrop-filter: blur(5px); align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s ease; }
    .modal-content { background: #111; border: 1px solid #333; width: 90%; max-width: 600px; border-radius: 12px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); overflow: hidden; transform: scale(0.9); transition: transform 0.3s ease; display: flex; flex-direction: column; max-height: 80vh; }
    .modal-header { padding: 20px; border-bottom: 1px solid #222; display: flex; justify-content: space-between; align-items: center; background: #161616; }
    .modal-title { margin: 0; font-size: 1.2rem; font-weight: 600; color: #fff; }
    .close-btn { background: none; border: none; color: #666; cursor: pointer; padding: 5px; transition: 0.2s; display: flex; }
    .close-btn:hover { color: #fff; }
    
    /* FILE LIST IN MODAL */
    #fileList { padding: 10px; overflow-y: auto; flex-grow: 1; }
    .file-row { display: flex; align-items: center; justify-content: space-between; padding: 15px; margin-bottom: 5px; background: rgba(255,255,255,0.03); border-radius: 8px; cursor: pointer; transition: 0.2s; text-decoration: none; color: #eee; border: 1px solid transparent; }
    .file-row:hover { background: rgba(255,255,255,0.08); border-color: #00ff88; transform: translateX(5px); }
    .file-info { display: flex; align-items: center; gap: 12px; }
    .file-icon { color: #00ff88; }
    .folder-icon { color: #f4d03f; }
    .file-size { font-size: 0.8em; color: #888; background: rgba(0,0,0,0.4); padding: 3px 8px; border-radius: 4px; }
    
    /* LOADING SPINNER */
    .spinner { border: 3px solid rgba(255,255,255,0.1); border-radius: 50%; border-top: 3px solid #00ff88; width: 24px; height: 24px; animation: spin 1s linear infinite; margin: 20px auto; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .back-row { padding: 10px 15px; color: #888; cursor: pointer; font-size: 0.9em; display: flex; align-items: center; gap: 5px; }
    .back-row:hover { color: #fff; }
</style>
</head>

<body>
    <canvas id="trail-canvas"></canvas>

    <header class="header" style="text-align: center; padding: 40px 20px;">
        <div id="header-content">
            <img id="userPhoto" src="assets/img/casanova.png" alt="casanova Logo">
            <h1 id="userName" style="margin: 10px 0;">Rajdeep.</h1>
            <span class="text" style="color: #aaa;">20. Student | Android Developer. he/him</span>
            <div id="links" style="margin-top: 20px;">
                <a class="link" href="https://github.com/rajdeep-3305" target="_blank" rel="noopener">GitHub</a>
                <a class="link" href="https://t.me/casanova_3305" target="_blank" rel="noopener">Telegram</a>
            </div>
        </div>
    </header>

    <div id="projects" style="max-width: 800px; margin: 0 auto; padding: 0 20px;">
        <h1 class="header-text" style="border-bottom: 1px solid #333; padding-bottom: 10px; margin-bottom: 30px;">My Projects</h1>
        
        <div class="table">
            <h2>device_xiaomi_rubyx</h2>
            <span class="text" style="display:block; margin-bottom:15px; color:#ccc;">Device trees for Redmi Note 12 Pro(+) 5G [rubyx]</span>
            <div class="buttons">
                <a class="button" href="https://github.com/rajdeep-3305/device_xiaomi_rubyx" target="_blank" rel="noopener">View Source</a>
                
                <button class="button" onclick="openModal()" style="border-color: #00ff88; color: #00ff88; box-shadow: 0 0 10px rgba(0,255,136,0.1);">
                    <span class="material-symbols-outlined" style="font-size: 16px; margin-right: 5px;">cloud_download</span>
                    Download Builds
                </button>
            </div>
        </div>

        <div class="table">
            <h2>rajdeep-3305.github.io</h2>
            <span class="text" style="display:block; margin-bottom:15px; color:#ccc;">This website's source code.</span>
            <div class="buttons">
                <a class="button" href="https://github.com/rajdeep-3305/rajdeep-3305.github.io" target="_blank" rel="noopener">GitHub</a>
            </div>
        </div>
    </div>

    <div id="about" style="max-width: 800px; margin: 40px auto; padding: 0 20px;">
        <h1 class="header-text" style="border-bottom: 1px solid #333; padding-bottom: 10px; margin-bottom: 30px;">About me</h1>
        <div class="table">
            <h2>Rajdeep.</h2>
            <span class="text" style="color:#ccc;">I’m an Electrical Engineering student, interested in Open-Source Android.</span>
        </div>
    </div>

    <footer style="text-align: center; padding: 40px; color: #666; font-size: 0.9em;">
        Made with love. <br> casanova. © 2025.
    </footer>

    <div id="romModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Select Build</h3>
                <button class="close-btn" onclick="closeModal()">
                    <span class="material-symbols-rounded">close</span>
                </button>
            </div>
            <div id="fileList">
                </div>
        </div>
    </div>

    <script>
        const WORKER_URL = "https://casanova-cloud.rajdeep-3305.workers.dev";
        
        let folderHistory = [];
        const modal = document.getElementById('romModal');
        const list = document.getElementById('fileList');

        function openModal() {
            modal.style.display = 'flex';
            setTimeout(() => {
                modal.style.opacity = '1';
                document.querySelector('.modal-content').style.transform = 'scale(1)';
            }, 10);
            loadFiles();
        }

        function closeModal() {
            modal.style.opacity = '0';
            document.querySelector('.modal-content').style.transform = 'scale(0.9)';
            setTimeout(() => {
                modal.style.display = 'none';
                folderHistory = [];
            }, 300);
        }

        async function loadFiles(folderId = null) {
            list.innerHTML = '<div class="spinner"></div>';
            try {
                const response = await fetch(WORKER_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ folderId: folderId })
                });
                const data = await response.json();
                renderFiles(data.files, folderId);
            } catch (error) {
                list.innerHTML = '<p style="text-align:center; color:#ff5555; padding:20px;">Error loading files.</p>';
            }
        }

        function renderFiles(files, currentFolder) {
            list.innerHTML = '';
            if (folderHistory.length > 0) {
                const backDiv = document.createElement('div');
                backDiv.className = 'back-row';
                backDiv.innerHTML = '<span class="material-symbols-rounded">arrow_back</span> Back';
                backDiv.onclick = () => {
                    folderHistory.pop();
                    const prev = folderHistory.length > 0 ? folderHistory[folderHistory.length - 1] : null;
                    loadFiles(prev);
                };
                list.appendChild(backDiv);
            }

            if (!files || files.length === 0) {
                list.innerHTML += '<p style="text-align:center; color:#666; padding:20px;">Empty folder.</p>';
                return;
            }

            files.forEach(f => {
                const isFolder = f.mimeType === 'application/vnd.google-apps.folder';
                const div = document.createElement('div');
                div.className = 'file-row';
                
                let icon = isFolder ? 'folder' : 'android';
                if (!isFolder && f.name.endsWith('.zip')) icon = 'folder_zip';
                
                div.innerHTML = `
                    <div class="file-info">
                        <span class="material-symbols-rounded ${isFolder ? 'folder-icon' : 'file-icon'}">${icon}</span>
                        <span>${f.name}</span>
                    </div>
                    ${isFolder ? '<span class="material-symbols-rounded" style="font-size:16px; color:#666;">chevron_right</span>' : `<span class="file-size">${formatSize(f.size)}</span>`}
                `;

                div.onclick = () => {
                    if (isFolder) {
                        folderHistory.push(f.id);
                        loadFiles(f.id);
                    } else {
                        window.location.href = `${WORKER_URL}/${f.id}`;
                    }
                };
                list.appendChild(div);
            });
        }

        function formatSize(s) {
            if (!s) return "";
            var i = Math.floor(Math.log(s) / Math.log(1024));
            return (s / Math.pow(1024, i)).toFixed(2) * 1 + " " + ["B", "kB", "MB", "GB", "TB"][i];
        }

        window.onclick = function(event) {
            if (event.target == modal) closeModal();
        }
    </script>

    <script>
        const canvas = document.getElementById('trail-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        let mouse = { x: undefined, y: undefined };
        let lastMouse = { x: undefined, y: undefined };
        
        window.addEventListener('mousemove', (e) => {
            mouse.x = e.x;
            mouse.y = e.y;
            
            if (lastMouse.x === undefined) {
                lastMouse.x = mouse.x;
                lastMouse.y = mouse.y;
                return;
            }

            const dx = mouse.x - lastMouse.x;
            const dy = mouse.y - lastMouse.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            const step = 2; 
            
            for (let i = 0; i < distance; i += step) {
                const percent = i / distance;
                const x = lastMouse.x + (dx * percent);
                const y = lastMouse.y + (dy * percent);
                particles.push(new Particle(x, y));
            }

            lastMouse.x = mouse.x;
            lastMouse.y = mouse.y;
        });

        window.addEventListener('mousedown', (e) => {
            for (let i = 0; i < 15; i++) {
                const p = new Particle(e.x, e.y);
                p.speedX = (Math.random() - 0.5) * 8;
                p.speedY = (Math.random() - 0.5) * 8;
                p.size = Math.random() * 3 + 2;
                p.life = 1.5;
                particles.push(p);
            }
        });

        class Particle {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.size = Math.random() * 8 + 2; 
                this.speedX = Math.random() * 0.4 - 0.2;
                this.speedY = Math.random() * 0.4 - 0.2;
                this.life = 1.0; 
            }

            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.life -= 0.015; 
            }

            draw() {
                const gradient = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.size);
                gradient.addColorStop(0, 'rgba(255, 255, 255, ' + (this.life * 0.3) + ')'); 
                gradient.addColorStop(1, 'rgba(255, 255, 255, 0)');

                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function animate() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.15)'; 
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            ctx.globalCompositeOperation = 'lighter';

            for (let i = 0; i < particles.length; i++) {
                particles[i].update();
                particles[i].draw();
                
                if (particles[i].life <= 0) {
                    particles.splice(i, 1);
                    i--;
                }
            }
            
            ctx.globalCompositeOperation = 'source-over';
            requestAnimationFrame(animate);
        }
        
        animate();

        // 3D TILT EFFECT FOR CARDS
        const cards = document.querySelectorAll('.table');
        cards.forEach(card => {
            card.addEventListener('mousemove', (e) => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                
                const rotateX = ((y - centerY) / centerY) * -10;
                const rotateY = ((x - centerX) / centerX) * 10;

                card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.02)`;
            });

            card.addEventListener('mouseleave', () => {
                card.style.transform = `perspective(1000px) rotateX(0) rotateY(0) scale(1)`;
            });
        });
    </script>
</body>
</html>
